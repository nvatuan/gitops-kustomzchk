## üõ°Ô∏è Policy Evaluation

| **Environments** | **Success** | **Omitted** | **Failed** | **Errored** | **F(Blocking)** | **F(Warning)** | **F(Recommend)** |
|--------------|---------|---------|--------|---------|---------|---------|---------|
{{range $env, $sum := .PolicyEvaluation.EnvironmentSummary}}| `{{ $env }}` | `{{ $sum.PolicyCounts.TotalSuccess }}`‚úÖ | `{{ $sum.PolicyCounts.TotalOmitted }}`‚è≠Ô∏è | `{{ $sum.PolicyCounts.TotalFailed }}`‚ùå | `{{ $sum.PolicyCounts.TotalErrored }}`üî• | `{{ $sum.PolicyCounts.BlockingFailedCount }}`üö´ | `{{ $sum.PolicyCounts.WarningFailedCount }}`‚ö†Ô∏è | `{{ $sum.PolicyCounts.RecommendFailedCount }}`üí° |
{{ end }}

<details> <summary> Policy Evaluation Matrix: </summary>

| Policy Name | Level | stg | prod |
|-------------|-------|-----|------|
{{range $policy := .PolicyEvaluation.PolicyMatrix.stg.BlockingPolicies}}| {{if $policy.ExternalLink}}[{{$policy.PolicyName}}]({{$policy.ExternalLink}}){{else}}{{$policy.PolicyName}}{{end}} | üö´ | {{if eq $policy.EvaluationStatus "pass"}}‚úÖ PASS{{else if eq $policy.EvaluationStatus "fail"}}‚ùå FAIL{{else}}üî• ERROR{{end}} | {{range $prodPolicy := $.PolicyEvaluation.PolicyMatrix.prod.BlockingPolicies}}{{if eq $prodPolicy.PolicyId $policy.PolicyId}}{{if eq $prodPolicy.EvaluationStatus "pass"}}‚úÖ PASS{{else if eq $prodPolicy.EvaluationStatus "fail"}}‚ùå FAIL{{else}}üî• ERROR{{end}}{{end}}{{end}} |
{{end -}}
{{range $policy := .PolicyEvaluation.PolicyMatrix.stg.WarningPolicies}}| {{if $policy.ExternalLink}}[{{$policy.PolicyName}}]({{$policy.ExternalLink}}){{else}}{{$policy.PolicyName}}{{end}} | ‚ö†Ô∏è | {{if eq $policy.EvaluationStatus "pass"}}‚úÖ PASS{{else if eq $policy.EvaluationStatus "fail"}}‚ùå FAIL{{else}}üî• ERROR{{end}} | {{range $prodPolicy := $.PolicyEvaluation.PolicyMatrix.prod.WarningPolicies}}{{if eq $prodPolicy.PolicyId $policy.PolicyId}}{{if eq $prodPolicy.EvaluationStatus "pass"}}‚úÖ PASS{{else if eq $prodPolicy.EvaluationStatus "fail"}}‚ùå FAIL{{else}}üî• ERROR{{end}}{{end}}{{end}} |
{{end -}}
{{range $policy := .PolicyEvaluation.PolicyMatrix.stg.RecommendPolicies}}| {{if $policy.ExternalLink}}[{{$policy.PolicyName}}]({{$policy.ExternalLink}}){{else}}{{$policy.PolicyName}}{{end}} | üí° | {{if eq $policy.EvaluationStatus "pass"}}‚úÖ PASS{{else if eq $policy.EvaluationStatus "fail"}}‚ùå FAIL{{else}}üî• ERROR{{end}} | {{range $prodPolicy := $.PolicyEvaluation.PolicyMatrix.prod.RecommendPolicies}}{{if eq $prodPolicy.PolicyId $policy.PolicyId}}{{if eq $prodPolicy.EvaluationStatus "pass"}}‚úÖ PASS{{else if eq $prodPolicy.EvaluationStatus "fail"}}‚ùå FAIL{{else}}üî• ERROR{{end}}{{end}}{{end}} |
{{end -}}
{{range $policy := .PolicyEvaluation.PolicyMatrix.stg.OverriddenPolicies}}| {{if $policy.ExternalLink}}[{{$policy.PolicyName}}]({{$policy.ExternalLink}}){{else}}{{$policy.PolicyName}}{{end}} | ‚è≠Ô∏è | {{if eq $policy.EvaluationStatus "pass"}}‚úÖ PASS{{else if eq $policy.EvaluationStatus "fail"}}‚ùå FAIL{{else}}üî• ERROR{{end}} | {{range $prodPolicy := $.PolicyEvaluation.PolicyMatrix.prod.OverriddenPolicies}}{{if eq $prodPolicy.PolicyId $policy.PolicyId}}{{if eq $prodPolicy.EvaluationStatus "pass"}}‚úÖ PASS{{else if eq $prodPolicy.EvaluationStatus "fail"}}‚ùå FAIL{{else}}üî• ERROR{{end}}{{end}}{{end}} |
{{end -}}
{{range $policy := .PolicyEvaluation.PolicyMatrix.stg.NotInEffectPolicies}}| {{if $policy.ExternalLink}}[{{$policy.PolicyName}}]({{$policy.ExternalLink}}){{else}}{{$policy.PolicyName}}{{end}} | ‚è≠Ô∏è | {{if eq $policy.EvaluationStatus "pass"}}‚úÖ PASS{{else if eq $policy.EvaluationStatus "fail"}}‚ùå FAIL{{else}}üî• ERROR{{end}} | {{range $prodPolicy := $.PolicyEvaluation.PolicyMatrix.prod.NotInEffectPolicies}}{{if eq $prodPolicy.PolicyId $policy.PolicyId}}{{if eq $prodPolicy.EvaluationStatus "pass"}}‚úÖ PASS{{else if eq $prodPolicy.EvaluationStatus "fail"}}‚ùå FAIL{{else}}üî• ERROR{{end}}{{end}}{{end}} |
{{end}}

</details>

<details> <summary> Failing Policies Details: </summary>

{{- if or (gt .PolicyEvaluation.EnvironmentSummary.stg.PolicyCounts.TotalErrored 0) (gt .PolicyEvaluation.EnvironmentSummary.prod.PolicyCounts.TotalErrored 0) }}

### üî• ERRORED Policies (Evaluation Failure)

##### [`stg`] environment 

{{- if gt .PolicyEvaluation.EnvironmentSummary.stg.PolicyCounts.BlockingErroredCount 0 }}
**üö´ BLOCKING:**
{{range $policy := .PolicyEvaluation.PolicyMatrix.stg.BlockingPolicies}}{{if eq $policy.EvaluationStatus "error"}}
* Policy `{{$policy.PolicyName}}` errored: {{$policy.ErrorMessage}}
{{end}}{{end}}
{{end}}

{{- if gt .PolicyEvaluation.EnvironmentSummary.stg.PolicyCounts.WarningErroredCount 0 }}
**‚ö†Ô∏è WARNING:**
{{range $policy := .PolicyEvaluation.PolicyMatrix.stg.WarningPolicies}}{{if eq $policy.EvaluationStatus "error"}}
* Policy `{{$policy.PolicyName}}` errored: {{$policy.ErrorMessage}}
{{end}}{{end}}
{{end}}

{{- if gt .PolicyEvaluation.EnvironmentSummary.stg.PolicyCounts.RecommendErroredCount 0 }}
**üí° RECOMMEND:**
{{range $policy := .PolicyEvaluation.PolicyMatrix.stg.RecommendPolicies}}{{if eq $policy.EvaluationStatus "error"}}
* Policy `{{$policy.PolicyName}}` errored: {{$policy.ErrorMessage}}
{{end}}{{end}}
{{end}}

{{- if and (eq .PolicyEvaluation.EnvironmentSummary.stg.PolicyCounts.BlockingErroredCount 0) (eq .PolicyEvaluation.EnvironmentSummary.stg.PolicyCounts.WarningErroredCount 0) (eq .PolicyEvaluation.EnvironmentSummary.stg.PolicyCounts.RecommendErroredCount 0) }}
* None! üôå
{{- end}}

##### [`prod`] environment 

{{- if gt .PolicyEvaluation.EnvironmentSummary.prod.PolicyCounts.BlockingErroredCount 0 }}
**üö´ BLOCKING:**
{{range $policy := .PolicyEvaluation.PolicyMatrix.prod.BlockingPolicies}}{{if eq $policy.EvaluationStatus "error"}}
* Policy `{{$policy.PolicyName}}` errored: {{$policy.ErrorMessage}}
{{end}}{{end}}
{{end}}

{{- if gt .PolicyEvaluation.EnvironmentSummary.prod.PolicyCounts.WarningErroredCount 0 }}
**‚ö†Ô∏è WARNING:**
{{range $policy := .PolicyEvaluation.PolicyMatrix.prod.WarningPolicies}}{{if eq $policy.EvaluationStatus "error"}}
* Policy `{{$policy.PolicyName}}` errored: {{$policy.ErrorMessage}}
{{end}}{{end}}
{{end}}

{{- if gt .PolicyEvaluation.EnvironmentSummary.prod.PolicyCounts.RecommendErroredCount 0 }}
**üí° RECOMMEND:**
{{range $policy := .PolicyEvaluation.PolicyMatrix.prod.RecommendPolicies}}{{if eq $policy.EvaluationStatus "error"}}
* Policy `{{$policy.PolicyName}}` errored: {{$policy.ErrorMessage}}
{{end}}{{end}}
{{end}}

{{- if and (eq .PolicyEvaluation.EnvironmentSummary.prod.PolicyCounts.BlockingErroredCount 0) (eq .PolicyEvaluation.EnvironmentSummary.prod.PolicyCounts.WarningErroredCount 0) (eq .PolicyEvaluation.EnvironmentSummary.prod.PolicyCounts.RecommendErroredCount 0) }}
* None! üôå
{{- end}}

{{end}}

#### üö´ BLOCKING Policies |{{range $env, $sum := .PolicyEvaluation.EnvironmentSummary}} `{{$env}}`: `{{$sum.PolicyCounts.BlockingFailedCount}}`‚ùå |{{end}}

##### [`stg`] environment 

{{- if gt .PolicyEvaluation.EnvironmentSummary.stg.PolicyCounts.BlockingFailedCount 0 }}

{{range $policy := .PolicyEvaluation.PolicyMatrix.stg.BlockingPolicies}}{{if eq $policy.EvaluationStatus "fail"}}
* Policy `{{$policy.PolicyName}}` failed with the following messages:
{{range $msg := $policy.FailMessages}}  * {{$msg}}
{{end}}
{{end}}{{end}}

{{else}}
* None! üôå
{{end}}

{{- if gt .PolicyEvaluation.EnvironmentSummary.prod.PolicyCounts.BlockingFailedCount 0 }}
##### [`prod`] environment 

{{range $policy := .PolicyEvaluation.PolicyMatrix.prod.BlockingPolicies}}{{if eq $policy.EvaluationStatus "fail"}}
* Policy `{{$policy.PolicyName}}` failed with the following messages:
{{range $msg := $policy.FailMessages}}  * {{$msg}}
{{end}}
{{end}}{{end}}
{{else}}
* None! üôå
{{end}}

#### ‚ö†Ô∏è WARNING Policies | {{range $env, $sum := .PolicyEvaluation.EnvironmentSummary}} `{{$env}}`: `{{$sum.PolicyCounts.WarningFailedCount}}`‚ùå |{{end}}

{{- if gt .PolicyEvaluation.EnvironmentSummary.stg.PolicyCounts.WarningFailedCount 0 }}
##### [`stg`] environment 

{{range $policy := .PolicyEvaluation.PolicyMatrix.stg.WarningPolicies}}{{if eq $policy.EvaluationStatus "fail"}}
* Policy `{{$policy.PolicyName}}` failed with the following messages:
{{range $msg := $policy.FailMessages}}  * {{$msg}}
{{end}}
{{end}}{{end}}
{{else}}
* None! üôå
{{end}}

{{- if gt .PolicyEvaluation.EnvironmentSummary.prod.PolicyCounts.WarningFailedCount 0 }}
##### [`prod`] environment 

{{range $policy := .PolicyEvaluation.PolicyMatrix.prod.WarningPolicies}}{{if eq $policy.EvaluationStatus "fail"}}
* Policy `{{$policy.PolicyName}}` failed with the following messages:
{{range $msg := $policy.FailMessages}}  * {{$msg}}
{{end}}
{{end}}{{end}}
{{else}}
* None! üôå
{{end}}

#### üí° RECOMMEND Policies | {{range $env, $sum := .PolicyEvaluation.EnvironmentSummary}} `{{$env}}`: `{{$sum.PolicyCounts.RecommendFailedCount}}`‚ùå |{{end}}

{{- if gt .PolicyEvaluation.EnvironmentSummary.stg.PolicyCounts.RecommendFailedCount 0 }}
##### [`stg`] environment 

{{range $policy := .PolicyEvaluation.PolicyMatrix.stg.RecommendPolicies}}{{if eq $policy.EvaluationStatus "fail"}}
* Policy `{{$policy.PolicyName}}` failed with the following messages:
{{range $msg := $policy.FailMessages}}  * {{$msg}}
{{end}}
{{end}}{{end}}
{{else}}
* None! üôå
{{end}}

##### [`prod`] environment 

{{- if gt .PolicyEvaluation.EnvironmentSummary.prod.PolicyCounts.RecommendFailedCount 0 }}

{{range $policy := .PolicyEvaluation.PolicyMatrix.prod.RecommendPolicies}}{{if eq $policy.EvaluationStatus "fail"}}
* Policy `{{$policy.PolicyName}}` failed with the following messages:
{{range $msg := $policy.FailMessages}}  * {{$msg}}
{{end}}
{{end}}{{end}}
{{else}}
* None! üôå
{{end}}

#### ‚è≠Ô∏è Omitted Policies | {{range $env, $sum := .PolicyEvaluation.EnvironmentSummary}} `{{$env}}`: `{{$sum.PolicyCounts.TotalOmittedFailed}}`‚ùå |{{end}}

##### [`stg`] environment 

{{- if gt .PolicyEvaluation.EnvironmentSummary.stg.PolicyCounts.TotalOmittedFailed 0 }}

{{range $policy := .PolicyEvaluation.PolicyMatrix.stg.OverriddenPolicies}}{{if eq $policy.EvaluationStatus "fail"}}
* Policy `{{$policy.PolicyName}}` failed with the following messages:
{{range $msg := $policy.FailMessages}}  * {{$msg}}
{{end}}
{{end}}{{end}}

{{range $policy := .PolicyEvaluation.PolicyMatrix.stg.NotInEffectPolicies}}{{if eq $policy.EvaluationStatus "fail"}}
* Policy `{{$policy.PolicyName}}` failed with the following messages:
{{range $msg := $policy.FailMessages}}  * {{$msg}}
{{end}}
{{end}}{{end}}

{{else}}
* None! üôå
{{end}}

##### [`prod`] environment 

{{- if gt .PolicyEvaluation.EnvironmentSummary.prod.PolicyCounts.TotalOmittedFailed 0 }}

{{range $policy := .PolicyEvaluation.PolicyMatrix.prod.OverriddenPolicies}}{{if eq $policy.EvaluationStatus "fail"}}
* Policy `{{$policy.PolicyName}}` failed with the following messages:
{{range $msg := $policy.FailMessages}}  * {{$msg}}
{{end}}
{{end}}{{end}}

{{range $policy := .PolicyEvaluation.PolicyMatrix.prod.NotInEffectPolicies}}{{if eq $policy.EvaluationStatus "fail"}}
* Policy `{{$policy.PolicyName}}` failed with the following messages:
{{range $msg := $policy.FailMessages}}  * {{$msg}}
{{end}}
{{end}}{{end}}

{{else}}
* None! üôå
{{end}}

</details>
